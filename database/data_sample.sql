INSERT INTO customers (name, gender, age, signup_date, income) VALUES
('John Doe', 'M', 28, '2022-06-15', 45000),
('Jane Smith', 'F', 34, '2023-02-20', 75000),
('Michael Johnson', 'M', 40, '2023-08-01', 90000),
('Emily Davis', 'F', 22, '2022-11-11', 35000),
('Chris Martin', 'M', 29, '2024-01-05', 50000),
('Olivia Brown', 'F', 31, '2023-05-22', 68000),
('Daniel Wilson', 'M', 37, '2023-07-30', 82000),
('Sophia Garcia', 'F', 26, '2022-09-17', 40000),
('David Lee', 'M', 45, '2022-04-23', 110000),
('Emma Hall', 'F', 38, '2023-10-10', 92000),
('James Young', 'M', 25, '2022-07-07', 42000),
('Mia Allen', 'F', 30, '2024-02-14', 60000),
('Benjamin King', 'M', 50, '2022-12-19', 120000),
('Amelia Wright', 'F', 27, '2023-03-05', 48000),
('Lucas Scott', 'M', 32, '2022-05-01', 70000),
('Harper Green', 'F', 29, '2023-11-11', 54000),
('Alexander Adams', 'M', 41, '2023-01-15', 95000),
('Ella Baker', 'F', 35, '2022-03-08', 72000),
('Henry Carter', 'M', 24, '2024-04-09', 38000),
('Avery Mitchell', 'F', 28, '2023-06-20', 57000),
('Sebastian Perez', 'M', 36, '2022-08-16', 85000),
('Abigail Roberts', 'F', 33, '2023-12-12', 76000),
('Liam Turner', 'M', 39, '2022-02-14', 88000),
('Charlotte Phillips', 'F', 23, '2024-03-18', 37000),
('Jackson Campbell', 'M', 27, '2023-04-21', 53000),
('Sofia Parker', 'F', 31, '2022-06-29', 65000),
('Jack Evans', 'M', 48, '2023-09-09', 99000),
('Isabella Edwards', 'F', 36, '2023-05-17', 82000),
('Owen Collins', 'M', 42, '2022-10-02', 102000),
('Chloe Stewart', 'F', 24, '2024-01-11', 39000),
('Wyatt Sanchez', 'M', 35, '2023-07-03', 87000),
('Grace Morris', 'F', 28, '2022-09-30', 58000),
('Gabriel Rogers', 'M', 31, '2022-05-05', 73000),
('Victoria Reed', 'F', 29, '2023-08-08', 64000),
('Carter Cook', 'M', 44, '2022-11-22', 105000),
('Penelope Morgan', 'F', 26, '2024-02-23', 47000),
('Julian Bell', 'M', 38, '2023-01-26', 91000),
('Lily Murphy', 'F', 25, '2022-04-04', 42000),
('Nathan Bailey', 'M', 30, '2022-07-12', 68000),
('Aria Rivera', 'F', 32, '2023-03-30', 73000),
('Christian Cooper', 'M', 33, '2022-08-27', 76000),
('Zoe Richardson', 'F', 27, '2023-12-19', 52000),
('Thomas Cox', 'M', 46, '2022-03-15', 115000),
('Stella Howard', 'F', 37, '2023-09-22', 80000),
('Hunter Ward', 'M', 41, '2022-01-19', 98000),
('Nora Peterson', 'F', 34, '2024-04-01', 71000),
('Eli Gray', 'M', 23, '2023-06-04', 36000),
('Hannah Ramirez', 'F', 30, '2022-06-26', 60000),
('Isaac James', 'M', 39, '2022-10-18', 89000),
('Audrey Watson', 'F', 31, '2023-11-30', 65000),
('Aaron Brooks', 'M', 27, '2022-04-09', 52000),
('Layla Ward', 'F', 35, '2023-08-17', 77000),
('Connor Hughes', 'M', 40, '2022-05-25', 92000),
('Scarlett Foster', 'F', 24, '2023-01-12', 39000),
('Levi Butler', 'M', 29, '2023-03-03', 57000),
('Ellie Simmons', 'F', 28, '2022-07-21', 61000),
('Dominic Russell', 'M', 36, '2022-09-16', 86000),
('Aurora Bryant', 'F', 32, '2023-10-05', 74000),
('Gavin Griffin', 'M', 47, '2022-03-28', 108000),
('Savannah Hayes', 'F', 38, '2023-12-25', 84000),
('Adrian West', 'M', 43, '2022-11-30', 101000),
('Paisley Coleman', 'F', 27, '2024-02-28', 54000),
('Lincoln Jenkins', 'M', 34, '2023-02-09', 79000),
('Violet Perry', 'F', 30, '2022-05-18', 67000),
('Jason Powell', 'M', 45, '2022-08-02', 112000),
('Brooklyn Long', 'F', 31, '2023-06-15', 72000),
('Easton Patterson', 'M', 26, '2023-03-22', 48000),
('Lucy Hughes', 'F', 29, '2022-07-29', 63000),
('Parker Flores', 'M', 37, '2022-04-11', 84000),
('Mila Washington', 'F', 33, '2023-10-19', 76000),
('Miles Butler', 'M', 41, '2022-02-08', 96000),
('Naomi Simmons', 'F', 34, '2023-09-01', 79000),
('Brody Simmons', 'M', 39, '2022-10-29', 88000),
('Clara Bryant', 'F', 26, '2024-03-10', 46000),
('Micah Hayes', 'M', 31, '2022-06-07', 73000),
('Anna Jenkins', 'F', 25, '2023-05-14', 62000),
('Kingston James', 'M', 35, '2022-08-24', 87000),
('Ruby West', 'F', 28, '2023-11-02', 68000),
('Juan Ramirez', 'M', 32, '2022-03-02', 75000),
('Sophie West', 'F', 30, '2023-07-26', 67000),
('Carlos Rogers', 'M', 44, '2022-09-05', 107000),
('Hailey Price', 'F', 37, '2023-12-06', 83000),
('Maxwell Bryant', 'M', 42, '2022-05-23', 102000),
('Madeline Griffin', 'F', 36, '2024-01-08', 80000),
('Asher Patterson', 'M', 23, '2023-02-14', 37000),
('Peyton Cox', 'F', 29, '2022-07-03', 64000),
('Sawyer Hughes', 'M', 33, '2023-03-19', 78000),
('Faith Foster', 'F', 31, '2022-04-20', 67000),
('Bryson Russell', 'M', 38, '2022-06-01', 91000),
('Eva Coleman', 'F', 27, '2023-08-30', 59000),
('Declan Perry', 'M', 40, '2022-09-20', 93000),
('Isabelle Patterson', 'F', 35, '2023-11-13', 78000),
('Cole Griffin', 'M', 46, '2022-03-07', 114000),
('Vivian Long', 'F', 39, '2023-05-30', 85000),
('Anderson Simmons', 'M', 41, '2022-10-11', 97000),
('London Hayes', 'F', 34, '2023-07-05', 76000);

INSERT INTO campaigns (campaign_name, start_date, end_date, description) VALUES
('Summer Sale Campaign A', '2024-06-01', '2024-06-30', 'Discounts up to 30% on selected items - Campaign A'),
('Summer Sale Campaign B', '2024-06-01', '2024-06-30', 'Discounts up to 30% on selected items - Campaign B');

INSERT INTO customer_campaigns (customer_id, campaign_id, assigned_date)
SELECT customer_id, 1, DATE '2024-06-01' + (random() * 29)::int
FROM customers
WHERE customer_id <= 50;

INSERT INTO customer_campaigns (customer_id, campaign_id, assigned_date)
SELECT customer_id, 2, DATE '2024-06-01' + (random() * 29)::int
FROM customers
WHERE customer_id > 50;

WITH selected_customers AS (
    SELECT customer_id
    FROM customers
    WHERE random() < 0.7
),
customer_campaigns_with_count AS (
    SELECT
        cc.customer_id,
        cc.campaign_id,
        (FLOOR(random() * 3 + 1))::int AS num_transactions
    FROM customer_campaigns cc
    JOIN selected_customers sc ON cc.customer_id = sc.customer_id
)
INSERT INTO transactions (customer_id, transaction_date, amount, campaign_id)
SELECT
    c.customer_id,
    DATE '2024-06-01' + (random() * 29)::int AS transaction_date,
    ROUND((10 + random() * 490)::numeric, 2) AS amount,
    c.campaign_id
FROM customer_campaigns_with_count c
JOIN generate_series(1, c.num_transactions) AS gen(x) ON TRUE;





